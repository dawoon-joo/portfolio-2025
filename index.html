<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" href="/common/css/font/font.css">
	<link rel="stylesheet" href="/common/css/swiper.min.css">
	<link rel="stylesheet" href="/common/css/jquery.fullpage.min.css">
	<link rel="stylesheet" href="/common/css/base.css">
	<link rel="stylesheet" href="/common/css/sub.css">
	<link rel="stylesheet" href="/common/css/main.css">
	<link rel="stylesheet" href="/common/css/common.css">
	<script src="/common/js/gsap.min.js"></script>
	<script src="/common/js/ScrollTrigger.min.js"></script>
	<script src="/common/js/ScrollToPlugin.min.js"></script>
	<script src="/common/js/ScrollMagic.min.js"></script>
	<script src="/common/js/scrollreveal.min.js"></script>
	<script src="/common/js/lenis.min.js"></script>
	<script src="/common/js/swiper.min.js"></script>
	<script src="/common/js/jquery-3.7.1.min.js"></script>
	<script src="/common/js/main.js"></script>
	<script src="/common/js/sub.js"></script>
	<script src="/common/js/device.js"></script>
	<script src="/common/js/header.js"></script>
	<script src="/common/js/common.js"></script>
</head>

<body>
	<header id="header" class="header" data-header-type="white">
		<h1>
			<a href="/" class="logo">
				<span class="blind">Test Logo</span>
			</a>
		</h1>
		<div class="gnb">
			<nav class="nav">
				<ul class="depth1" data-lenis-prevent>
					<li>
						<a href="#">Menu 1</a>
						<ul class="depth2">
							<li><a href="#">Sub Menu 1-1</a></li>
							<li><a href="#">Sub Menu 1-2</a></li>
							<li><a href="#">Sub Menu 1-3</a></li>
							<li><a href="#">Sub Menu 1-4</a></li>
							<li><a href="#">Sub Menu 1-5</a></li>
							<li><a href="#">Sub Menu 1-6</a></li>
						</ul>
					</li>
					<li>
						<a href="#">Menu 2</a>
						<ul class="depth2">
							<li><a href="#">Sub Menu 2-1</a></li>
							<li><a href="#">Sub Menu 2-2</a></li>
							<li><a href="#">Sub Menu 2-3</a></li>
							<li><a href="#">Sub Menu 2-4</a></li>
							<li><a href="#">Sub Menu 2-5</a></li>
						</ul>
					</li>
					<li>
						<a href="#">Menu 3</a>
						<ul class="depth2">
							<li><a href="#">Sub Menu 3-1</a></li>
							<li><a href="#">Sub Menu 3-2</a></li>
						</ul>
					</li>
					<li>
						<a href="#">Menu 4</a>
						<ul class="depth2">
							<li><a href="#">Sub Menu 4-1</a></li>
							<li><a href="#">Sub Menu 4-2</a></li>
						</ul>
					</li>
					<li>
						<a href="#">Menu 5</a>
					</li>
				</ul>
			</nav>
			<div class="close">
				<a href="javascript:">
					<span class="circle"></span>
					<span class="blind">Close Menu</span>
				</a>
			</div>
		</div>
		<div class="header-right">
			<div class="header-language">
				<button class="current" aria-pressed="false"><span class="text">KR</span></button>
				<ul>
					<li><a href="javascript:lang_chg('ko')">KR</a></li>
					<li><a href="javascript:lang_chg('en')">EN</a></li>
					<li><a href="javascript:lang_chg('cn')">CN</a></li>
				</ul>
			</div>
			<div class="hamburger">
				<a href="javascript:">
					<span class="bar"></span>
					<span class="bar"></span>
					<span class="bar"></span>
					<span class="blind">Open Menu</span>
				</a>
			</div>
		</div>
	</header>
	<main>
		<div class="intro">
			<div class="bg"></div>
			<div class="intro-text">
				<h2 class="title">
					<p class="split">Creative Web Publisher</p>
					<p class="split">4년간의 웹 퍼블리싱 여정과 함께</p>
					<p class="split">인터랙티브한 사용자 경험을 만들어갑니다.</p>
				</h2>
			</div>
		</div>
		<section class="sec sec1">
			<h1>안녕하세요 저는 주다운입니다. 만나서 반갑습니다.</h1>
		</section>
		<section class="sec"></section>
		<section class="sec"></section>
		<section class="sec"></section>
	</main>
	<footer id="footer" class="footer">
		<div class="inner">
			<div class="content-top">
				<div class="sitemap">
					<article>
						<dl>
							<dt><a href="javascript:">Menu 1</a></dt>
							<dd><a href="#">Sub Menu 1-1</a></dd>
							<dd><a href="#">Sub Menu 1-2</a></dd>
							<dd><a href="#">Sub Menu 1-3</a></dd>
							<dd><a href="#">Sub Menu 1-4</a></dd>
							<dd class="w-100"><a href="#">Sub Menu 1-5</a></dd>
							<dd class="w-100"><a href="#">Sub Menu 1-6</a></dd>
						</dl>
					</article>
					<article>
						<dl>
							<dt><a href="javascript:">Menu 2</a></dt>
							<dd><a href="#">Sub Menu 2-1</a></dd>
							<dd><a href="#">Sub Menu 2-2</a></dd>
							<dd><a href="#">Sub Menu 2-3</a></dd>
							<dd><a href="#">Sub Menu 2-4</a></dd>
							<dd><a href="#">Sub Menu 2-5</a></dd>
							<dd><a href="#">Sub Menu 2-6</a></dd>
							<dd><a href="#">Sub Menu 2-7</a></dd>
							<dd><a href="#">Sub Menu 2-8</a></dd>
						</dl>
					</article>
					<article>
						<dl>
							<dt><a href="javascript:">Menu 3</a></dt>
							<dd class="w-100"><a href="#">Sub Menu 3-1</a></dd>
							<dd class="w-100"><a href="#">Sub Menu 3-2</a></dd>
						</dl>
					</article>
					<article>
						<dl>
							<dt><a href="javascript:">Menu 4</a></dt>
							<dd class="w-100"><a href="#">Sub Menu 4-1</a></dd>
							<dd class="w-100"><a href="#">Sub Menu 4-2</a></dd>
						</dl>
					</article>
					<article>
						<dl>
							<dt><a href="javascript:">Menu 5</a></dt>
							<dd class="w-100"><a href="#">Sub Menu 5-1</a></dd>
							<dd class="w-100"><a href="#">Sub Menu 5-2</a></dd>
							<dd class="w-100"><a href="#">Sub Menu 5-3</a></dd>
							<dd class="w-100"><a href="#">Sub Menu 5-4</a></dd>
						</dl>
					</article>
				</div>
				<div class="con-right">
					<div class="phone"><a href="tel:0000000000">000-0000-0000</a></div>
					<ul class="footer-link">
						<li><a href="#">Link 1</a></li>
						<li><a href="#">Link 2</a></li>
						<li class="active"><a href="#">Link 3</a></li>
					</ul>
					<ul class="footer-sns">
						<li><a href="javascript:" title="새창으로 열림" target="_blank"><i class="icon icon-youtube"></i></a></li>
						<li><a href="javascript:" title="새창으로 열림" target="_blank"><i class="icon icon-kakao"></i></a></li>
						<li><a href="javascript:" title="새창으로 열림" target="_blank"><i class="icon icon-instagram"></i></a></li>
						<li><a href="javascript:" title="새창으로 열림" target="_blank"><i class="icon icon-facebook"></i></a></li>
						<li><a href="javascript:" title="새창으로 열림" target="_blank"><i class="icon icon-linkedin"></i></a></li>
					</ul>
				</div>
			</div>
			<div class="content-bottom">
				<div class="logo-box">
					<img src="/common/images/logo.png" alt="Test Logo">
				</div>
				<p class="copyright">©<span id="copyYear">2024</span> Test Company.</p>
				<div class="site-wrap">
					<button type="button" class="btn-site">Family Sites</button>
					<div class="ico ico-arrow-drop"><span class="hide">Arrow</span></div>
					<ul class="familyLink">
						<li><a href="#" target="_blank" title="새창으로 열림">Family Site 1</a></li>
						<li><a href="#" target="_blank" title="새창으로 열림">Family Site 2</a></li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
</body>
<script>
	const initCircleLayout = () => {
		const getElements = () => ({
			intro: document.querySelector('.intro'),
			sec1: document.querySelector('.sec1'),
			bg: document.querySelector('.intro .bg'),
			guideCircle: document.querySelector('.guide-circle'),
			articles: document.querySelectorAll('.guide-circle article'),
			split: document.querySelectorAll('.intro-text .split'),
		});
		
		// 등장 효과 (이미지가 보이게 됨)
		const createAppearMaskEffect = (progress) => {
			const config = {
				blockCount: 30,
				staggerFactor: 2
			};

			const blockWidth = 100 / config.blockCount;
			const adjustedProgress = (progress * (config.blockCount / config.staggerFactor)) / (config.blockCount / (config.staggerFactor + 1));

			const maskPatterns = Array.from({ length: config.blockCount }, (_, index) => {
				const blockStart = (index * blockWidth).toFixed(5);
				const blockEnd = ((index + 1) * blockWidth).toFixed(5);

				const appearanceThreshold = (config.blockCount - index - 1) / config.blockCount;
				const blockProgress = Math.max(0, Math.min(1,
					(adjustedProgress - appearanceThreshold) * config.staggerFactor
				));

				const blackEndPosition = (parseFloat(blockStart) + blockProgress * blockWidth).toFixed(5);
				const finalBlackEnd = Math.min(parseFloat(blackEndPosition), parseFloat(blockEnd)).toFixed(5);

				return `black ${blockStart}%, black ${finalBlackEnd}%, transparent ${finalBlackEnd}%, transparent ${blockEnd}%`;
			});

			return maskPatterns.join(', ');
		};
		// 퇴장 효과 (이미지가 사라짐)
		const createDisappearMaskEffect = (progress) => {
			const config = {
				blockCount: 30,
				staggerFactor: 2
			};

			const blockWidth = 100 / config.blockCount;
			const adjustedProgress = (progress * (config.blockCount / config.staggerFactor)) / (config.blockCount / (config.staggerFactor + 1));

			const maskPatterns = Array.from({ length: config.blockCount }, (_, index) => {
				const blockStart = (index * blockWidth).toFixed(5);
				const blockEnd = ((index + 1) * blockWidth).toFixed(5);

				// 왼쪽에서 오른쪽으로 사라지게
				const appearanceThreshold = index / config.blockCount;
				const blockProgress = Math.max(0, Math.min(1,
					(adjustedProgress - appearanceThreshold) * config.staggerFactor
				));

				const transparentEndPosition = (parseFloat(blockStart) + blockProgress * blockWidth).toFixed(5);
				const finalTransparentEnd = Math.min(parseFloat(transparentEndPosition), parseFloat(blockEnd)).toFixed(5);

				return `transparent ${blockStart}%, transparent ${finalTransparentEnd}%, black ${finalTransparentEnd}%, black ${blockEnd}%`;
			});

			return maskPatterns.join(', ');
		};

		const runMaskAnimation = (element, maskType) => {
			const { intro, bg, guideCircle, articles, split, sec1 } = getElements();
			// gsap.set(element, { autoAlpha: 0 });

			gsap.to({}, {
				duration: 1.5,
				onUpdate: function () {
					const progress = this.progress();
					const maskPattern = maskType(progress);
					element.style.setProperty('--mask-section', maskPattern);
				},
				onComplete: () => {
					document.body.style.overflow = 'visible';
					lenis.start();
					intro.remove();
				}
			});

			gsap.to(element, {
				autoAlpha: 1,
				duration: 0.1
			});
		};

		// 	const { guideCircle, articles } = getElements();
		// 	const radius = guideCircle.offsetWidth / 2;
		// 	const spacing = articles[0].offsetWidth + 400;
		// 	let maxHeight = 0;
		// 	articles.forEach(article => {
		// 		const height = article.offsetHeight;
		// 		if (height > maxHeight) {
		// 			maxHeight = height;
		// 		}
		// 	});

		// 	articles.forEach((article, index) => {
		// 		article.style.height = `${maxHeight}px`;
		// 		const arcLength = spacing * index;
		// 		const degrees = -90 + (arcLength / radius) * (180 / Math.PI);
		// 		const radians = degrees * (Math.PI / 180);

		// 		gsap.set(article, {
		// 			left: '50%',
		// 			top: '50%',
		// 			x: Math.cos(radians) * radius,
		// 			y: Math.sin(radians) * radius,
		// 			rotation: index === 0 ? 0 : degrees + 90,
		// 			xPercent: -50,
		// 			yPercent: -50
		// 		});
		// 	});
		// }

		function initScrollAnimation() {
			const { intro, bg, guideCircle, articles, split, sec1 } = getElements();
			const tl = gsap.timeline();
			split.forEach(item => {
				gsap.set(item.querySelectorAll('.word'), { autoAlpha: 0, y: 0 });
			});
			const totalDuration = 8;
			const segmentDuration = totalDuration / 3;
			const staggerTime = 0.05;

			document.body.style.overflow = 'hidden';
			lenis.stop();
			
			tl.to(split[0].querySelectorAll('.word'), { autoAlpha: 1, y: 0, ease: 'power2.inOut', stagger: staggerTime }, 'intro')
				.to(split[0].querySelectorAll('.word'), { autoAlpha: 0, y: 0, ease: 'power2.inOut', stagger: staggerTime }, 'intro+=' + (segmentDuration - 1))
				.to(split[1].querySelectorAll('.word'), { autoAlpha: 1, y: 0, ease: 'power2.inOut', stagger: staggerTime }, 'intro+=' + segmentDuration)
				.to(split[1].querySelectorAll('.word'), { autoAlpha: 0, y: 0, ease: 'power2.inOut', stagger: staggerTime }, 'intro+=' + (segmentDuration * 2 - 1))
				.to(split[2].querySelectorAll('.word'), {
					autoAlpha: 1, y: 0, ease: 'power2.inOut', stagger: staggerTime, onComplete: () => {
						runMaskAnimation(intro, createDisappearMaskEffect);
					}
				}, 'intro+=' + (segmentDuration * 2))
		}

		function reset() {
			ScrollTrigger.getAll().forEach(st => st.kill());
			initScrollAnimation();
		}

		// positionArticles();
		initScrollAnimation();
		window.addEventListener('resize', reset);
	}

	window.addEventListener('DOMContentLoaded', initCircleLayout);
</script>

</html>